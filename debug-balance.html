<!DOCTYPE html>
<html>
<head>
    <title>Debug Balance</title>
</head>
<body>
    <h1>Debug Balance System</h1>
    <div id="output"></div>
    
    <script>
        function debugBalance() {
            const output = document.getElementById('output');
            let html = '<h2>localStorage Debug</h2>';
            
            // Check all localStorage keys
            html += '<h3>All localStorage keys:</h3>';
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                html += `<strong>${key}:</strong> ${value}<br>`;
            }
            
            // Check specifically for the unified state
            html += '<h3>Unified State Check:</h3>';
            const unifiedState = localStorage.getItem('roflfaucet_demo_state');
            if (unifiedState) {
                html += `<strong>roflfaucet_demo_state found:</strong> ${unifiedState}<br>`;
                try {
                    const parsed = JSON.parse(unifiedState);
                    html += `<strong>Parsed credits:</strong> ${parsed.credits}<br>`;
                    html += `<strong>Parsed totalSpins:</strong> ${parsed.totalSpins}<br>`;
                    html += `<strong>Parsed totalWagered:</strong> ${parsed.totalWagered}<br>`;
                    html += `<strong>Parsed totalWon:</strong> ${parsed.totalWon}<br>`;
                } catch (e) {
                    html += `<strong>Error parsing:</strong> ${e.message}<br>`;
                }
            } else {
                html += '<strong>roflfaucet_demo_state:</strong> NOT FOUND<br>';
            }
            
            // Check JWT token
            html += '<h3>JWT Token Check:</h3>';
            const jwt = localStorage.getItem('jwt_token');
            html += `<strong>jwt_token:</strong> ${jwt ? 'EXISTS' : 'NOT FOUND'}<br>`;
            
            // Check if logged in
            const isLoggedIn = localStorage.getItem('jwt_token') !== null;
            html += `<strong>isLoggedIn:</strong> ${isLoggedIn}<br>`;
            
            output.innerHTML = html;
        }
        
        // Run debug immediately
        debugBalance();
        
        // Add button to refresh
        document.body.innerHTML += '<button onclick="debugBalance()">Refresh Debug</button>';
    </script>
</body>
</html>
